<!DOCTYPE html>
<html>
    <head>
        <title>CARDS</title>
        <link rel="stylesheet" href="styles.css">
        <link rel="stylesheet" href="../eReceipt/jquery-ui-1.12.1/jquery-ui.min.css">
        <link rel="stylesheet" href="../eReceipt/jquery-ui-1.12.1/jquery-ui.structure.min.css">
        <link rel="stylesheet" href="../eReceipt/jquery-ui-1.12.1/jquery-ui.theme.min.css">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
    </head>
    <body>
        <div id="computer" class="clearfix">

        </div>


        <div id="center" class="clearfix">
            <div id="market" ><p></p>  <span>whot</span></div>
            <div id="twenty">
                <div class="a" id="square"><div><i class="fas fa-square" style="font-size: 20px; color:#521717;  "></i></div></div>
                <div class="a" id="star"><div><i class="fas fa-star" style="font-size: 20px; color:#521717;  "></i></div></div>
                <div class="a" id="circle"><div><i class="fas fa-circle" style="font-size: 20px; color:#521717;  "></i></div></div>
                <div class="a" id="cross"><div><i class="fas fa-cross" style="font-size: 20px; color:#521717;  "></i></div></div>
                <div class="a" id="triangle"><div><i class="fas fa-play" style="font-size: 20px; color:#521717;  "></i></div></div>

            </div>

        </div>

        <div id="player">

        </div>

        <script src="../eReceipt/jquery-3.5.1.min.js"></script>
        <script src="../eReceipt/jquery-ui-1.12.1/jquery-ui.min.js"></script>
        <script>
            $(function () {
                // available card contains the number of cards available in the deck of card at any specific time
                var availableCard = [
                    {
                        number: 1,
                        shape: "circle"
                    },
                    {
                        number: 1,
                        shape: "triangle"
                    },
                    {
                        number: 1,
                        shape: "cross"
                    },
                    {
                        number: 1,
                        shape: "square"
                    },
                    {
                        number: 1,
                        shape: "star"
                    },
                    {
                        number: 2,
                        shape: "circle"
                    },
                    {
                        number: 2,
                        shape: "triangle"
                    },
                    {
                        number: 2,
                        shape: "cross"
                    },
                    {
                        number: 2,
                        shape: "square"
                    },
                    {
                        number: 2,
                        shape: "star"
                    },
                    {
                        number: 3,
                        shape: "circle"
                    },
                    {
                        number: 3,
                        shape: "triangle"
                    },
                    {
                        number: 3,
                        shape: "cross"
                    },
                    {
                        number: 3,
                        shape: "square"
                    },
                    {
                        number: 3,
                        shape: "star"
                    },
                    {
                        number: 4,
                        shape: "circle"
                    },
                    {
                        number: 4,
                        shape: "triangle"
                    },
                    {
                        number: 4,
                        shape: "star"
                    },
                    {
                        number: 5,
                        shape: "circle"
                    },
                    {
                        number: 5,
                        shape: "triangle"
                    },
                    {
                        number: 5,
                        shape: "cross"
                    },
                    {
                        number: 5,
                        shape: "square"
                    },
                    {
                        number: 5,
                        shape: "star"
                    },
                    {
                        number: 7,
                        shape: "circle"
                    },
                    {
                        number: 7,
                        shape: "triangle"
                    },
                    {
                        number: 7,
                        shape: "cross"
                    },
                    {
                        number: 7,
                        shape: "square"
                    },
                    {
                        number: 7,
                        shape: "star"
                    },
                    {
                        number: 8,
                        shape: "circle"
                    },
                    {
                        number: 8,
                        shape: "triangle"
                    },
                    {
                        number: 8,
                        shape: "star"
                    },
                    {
                        number: 10,
                        shape: "circle"
                    },
                    {
                        number: 10,
                        shape: "triangle"
                    },
                    {
                        number: 10,
                        shape: "cross"
                    },
                    {
                        number: 10,
                        shape: "square"
                    },
                    {
                        number: 11,
                        shape: "circle"
                    },
                    {
                        number: 11,
                        shape: "triangle"
                    },
                    {
                        number: 11,
                        shape: "cross"
                    },
                    {
                        number: 11,
                        shape: "square"
                    },
                    {
                        number: 12,
                        shape: "circle"
                    },
                    {
                        number: 12,
                        shape: "triangle"
                    },
                    {
                        number: 13,
                        shape: "circle"
                    },
                    {
                        number: 13,
                        shape: "triangle"
                    },
                    {
                        number: 13,
                        shape: "cross"
                    },
                    {
                        number: 13,
                        shape: "square"
                    },
                    {
                        number: 14,
                        shape: "circle"
                    },
                    {
                        number: 14,
                        shape: "triangle"
                    },
                    {
                        number: 14,
                        shape: "cross"
                    },
                    {
                        number: 14,
                        shape: "square"
                    },
                    {
                        number: 20,
                        shape: "whot"
                    },
                    {
                        number: 20,
                        shape: "whot"
                    },
                    {
                        number: 20,
                        shape: "whot"
                    },
                    {
                        number: 20,
                        shape: "whot"
                    }
                ]

                // current player 1 for player, 0 for computer
                var currentPlayer = 1

                // Cards already played
                var played = []

                // The dashCards functions calls on the pick function 'number' number of times to dash out cards to a particulay player
                function dashCards(number, player) {
                    for (i = 0; i<number; i++){
                        pick(player)
                    }
                }

                // The pick function picks a random card from the availableCard array
                function pick(n) {
                    if (availableCard.length == 0) {
                        availableCard = played
                        played = []
                    } else {
                        var r =  Math.floor(Math.random() * availableCard.length)
                        render(r, n)
                    }
                }

                dashCards(5, 0)
                dashCards(5, 1)
                dashCards(1)

                // The render function takes in the index number of the random generated number and the currentPlayer and display cards for each player
                function render(re, z) {
                    if (availableCard[re] == undefined) {
                        console.log(availableCard[re])
                        pick(n)
                    } else {
                        let cardNum = availableCard[re]['number']
                        let cardShape = availableCard[re]['shape']
                        var div;
                        var x ;
                        var s = 'fas fa-square'
                        var t = 'fas fa-play'
                        var c = 'fas fa-circle'
                        var st = 'fas fa-star'
                        var w = 'fas fa-whot'
                        var cr = 'fas fa-cross'
                        var shapes;

                        if (cardShape == 'square'){
                            shapes = s
                        }else if (cardShape == 'triangle'){
                            shapes = t
                        }else if (cardShape == 'circle'){
                            shapes = c
                        }else if (cardShape == 'star'){
                            shapes = st
                        }else if (cardShape == 'cross'){
                            shapes = cr
                        } else {
                            shapes = w
                        }

                        var computerCAS = []
                        if (z == 0) {
                            x = '#computer'
                            computerCAS.push(availableCard[re])
                            div = `<div class="ndraggable" style="height: 250px; width: 200px; background-color: wheat; position: relative;"><p style="color:#521717; font-weight: bolder; font-size: xx-large;">${cardNum}</p><span>${cardShape}</span><div style="position: absolute; top: 33px; left: 7px; " > <i class="${shapes}" style="font-size: 20px; color:#521717;"></i></div><div  style="position: absolute; top: 70px; left: 50px; " > <i class="${shapes}" style="font-size: 100px; color:#521717;  "></i></div><div style="position: absolute; bottom: 4px; right: 4px; " > <i class="${shapes}" style="font-size: 20px; color:#521717;"></i></div></div>`
                        } else if (z == 1) {
                            x = '#player'
                            div = `<div class="draggable" style="height: 250px; width: 200px; background-color: wheat; position: relative;"><p style="color:#521717; font-weight: bolder; font-size: xx-large;">${cardNum}</p><span>${cardShape}</span><div style="position: absolute; top: 33px; left: 7px; " > <i class="${shapes}" style="font-size: 20px; color:#521717;"></i></div><div  style="position: absolute; top: 70px; left: 50px; " > <i class="${shapes}" style="font-size: 100px; color:#521717;  "></i></div><div style="position: absolute; bottom: 32px; right: 12px; " > <i class="${shapes}" style="font-size: 20px; color:#521717; "></i></div></div>`
                        } else {
                            x = '#center'
                            div = `<div id="droppable" style="height: 250px; width: 200px; background-color: wheat; position: relative;"><p style="color:#521717; font-weight: bolder; font-size: xx-large;">${cardNum}</p><span>${cardShape}</span><div style="position: absolute; top: 33px; left: 7px; " > <i class="${shapes}" style="font-size: 20px; color:#521717;"></i></div><div  style="position: absolute; top: 70px; left: 50px; " > <i class="${shapes}" style="font-size: 100px; color:#521717;  "></i></div><div style="position: absolute; bottom: 32px; right: 12px; " > <i class="${shapes}" style="font-size: 20px; color:#521717; "></i></div></div>`
                        }
                        $(x).append(div)


                            $('.draggable').draggable({
                                revert: true
                            })


                        availableCard.splice(re, 1)
                    }
                }
                $('.draggable').draggable()
                $('#droppable').droppable(
                    {
                        drop: function(event, ui){
                            var draggedNum = $(ui.draggable).find('p').text()
                            var draggedSha = $(ui.draggable).find('span').text()
                            var v = dropCheck(draggedNum, draggedSha)
                            if (v == true) {
                                alert()
                                $(this).html($(ui.draggable.html()))
                                $(ui.draggable).css('display', 'none')
                                if (draggedNum == 2) {
                                    twoCount++
                                    passTurn()
                                } else if (draggedNum == 5) {
                                    fiveCount++
                                    passTurn()
                                } else if (draggedNum == 14) {
                                    twoCount = 0
                                    fiveCount = 0
                                    currentPlayer = 0
                                    dashCards(1, currentPlayer)
                                    passTurn()
                                } else if (draggedNum == 8) {
                                    twoCount = 0
                                    fiveCount = 0
                                    currentPlayer = 0
                                    passTurn()
                                } else if (draggedNum == 20) {
                                    twoCount = 0
                                    fiveCount = 0
                                    twenty()
                                } else {
                                    twoCount = 0
                                    fiveCount = 0
                                    passTurn()
                                }
                            }
                        }
                    }
                )

                var twoCount
                var fiveCount
                var whotShape

                function dropCheck(p, span) {
                    var dropNum = $('#droppable').find('p').text()
                    var dropSha = $('#droppable').find('span').text()
                    // alert()
                    if (dropNum == 2) {
                        if(p == 2) {
                            twoCount++
                            return true
                        } else {
                            return false
                        }
                    } else if (dropNum == 5) {
                        if (p == 5) {
                            fiveCount++
                            return true
                        } else {
                            return false
                        }
                    } else if (dropNum == 8){
                        return true
                    } else if (dropNum == 20) {
                        if (p == 20 || span == whotShape){
                            return true
                        } else {
                            return false
                        }
                    } else if (p == dropNum || span == dropSha || p == 20) {
                        return true
                    } else {
                        return false
                    }
                }

                function twenty() {
                    $('#twenty').css('visibility', 'visible')
                    $('.a').on('click', function(){
                        whotShape = $(this).attr('id')
                        $('#twenty').css('visibility', 'hidden')
                        passTurn()
                    })

                }


            })


        </script>
    </body>
</html>